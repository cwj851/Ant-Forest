[{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/150","repository_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest","labels_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/150/labels{/name}","comments_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/150/comments","events_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/150/events","html_url":"https://github.com/TonyJiangWJ/Ant-Forest/issues/150","id":1238033777,"node_id":"I_kwDODYW6PM5JyuVx","number":150,"title":"CDN被墙了 可视化配置 打不开的解决方案","user":{"login":"TonyJiangWJ","id":11325805,"node_id":"MDQ6VXNlcjExMzI1ODA1","avatar_url":"https://avatars.githubusercontent.com/u/11325805?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyJiangWJ","html_url":"https://github.com/TonyJiangWJ","followers_url":"https://api.github.com/users/TonyJiangWJ/followers","following_url":"https://api.github.com/users/TonyJiangWJ/following{/other_user}","gists_url":"https://api.github.com/users/TonyJiangWJ/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyJiangWJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyJiangWJ/subscriptions","organizations_url":"https://api.github.com/users/TonyJiangWJ/orgs","repos_url":"https://api.github.com/users/TonyJiangWJ/repos","events_url":"https://api.github.com/users/TonyJiangWJ/events{/privacy}","received_events_url":"https://api.github.com/users/TonyJiangWJ/received_events","type":"User","site_admin":false},"labels":[{"id":1723540497,"node_id":"MDU6TGFiZWwxNzIzNTQwNDk3","url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/labels/documentation","name":"documentation","color":"0075ca","default":true,"description":"Improvements or additions to documentation"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-17T04:08:25Z","updated_at":"2022-05-17T04:22:42Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"修改如下文件\r\nvue_configs/index.html log-read.html\r\nvue_configs/js/jsLoader.js \r\n全部的 cdn.jsdelivr 替换为fastly.jsdelivr\r\n再在可视化配置.js第46行插入 ui.webview.clearCache(true)\r\n下次发布","reactions":{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/150/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/150/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/149","repository_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest","labels_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/149/labels{/name}","comments_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/149/comments","events_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/149/events","html_url":"https://github.com/TonyJiangWJ/Ant-Forest/issues/149","id":1236230822,"node_id":"I_kwDODYW6PM5Jr2Km","number":149,"title":"在AutoJS脚本中利用小米运动刷步数","user":{"login":"TonyJiangWJ","id":11325805,"node_id":"MDQ6VXNlcjExMzI1ODA1","avatar_url":"https://avatars.githubusercontent.com/u/11325805?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyJiangWJ","html_url":"https://github.com/TonyJiangWJ","followers_url":"https://api.github.com/users/TonyJiangWJ/followers","following_url":"https://api.github.com/users/TonyJiangWJ/following{/other_user}","gists_url":"https://api.github.com/users/TonyJiangWJ/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyJiangWJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyJiangWJ/subscriptions","organizations_url":"https://api.github.com/users/TonyJiangWJ/orgs","repos_url":"https://api.github.com/users/TonyJiangWJ/repos","events_url":"https://api.github.com/users/TonyJiangWJ/events{/privacy}","received_events_url":"https://api.github.com/users/TonyJiangWJ/received_events","type":"User","site_admin":false},"labels":[{"id":1723540497,"node_id":"MDU6TGFiZWwxNzIzNTQwNDk3","url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/labels/documentation","name":"documentation","color":"0075ca","default":true,"description":"Improvements or additions to documentation"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2022-05-15T09:11:22Z","updated_at":"2022-05-15T09:11:22Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"### 使用脚本方式刷支付宝运动步数\r\n- 刷运动步数，除了使用Python的云函数，也可以使用如下脚本，实现方式是一样的\r\n- 下载小米运动APP 现在名字叫 Zepp Life\r\n- 注册一个账号  手机号可以直接注册 邮箱的需要选择地区为 其他 因为明文保存密码，建议使用邮箱注册并且使用不常用的弱密码\r\n- 这一步非常重要 否则刷的步数无意义：登录后进入APP的第三方接入 绑定到支付宝\r\n- 然后在下面的accounts中配置一下用户名密码 手机号的需要增加+86前缀 邮箱的不需要\r\n- 然后运行当前脚本即可自动刷步数数据 如果不需要随机的步数将min和max改成相同即可 或者可以将范围改大一些\r\n- 运行完毕后APP将会被踢出登录，先试一下 数据能到支付宝之后就可以将APP卸载，后续每天修改步数后都会通过华米自有协议同步到支付宝中不再需要打开APP\r\n- 对当前脚本设置一个每日自动执行的定时任务即可每天自动刷步数了 建议时间为晚上\r\n- 目前运动步数详情是写死的，建议每天就刷一次就行\r\n- 随便创建一个JS文件 可以放在任意位置 文件内容如下代码\r\n```javascript\r\n/*\r\n * @Author: TonyJiangWJ\r\n * @Date: 2022-05-15 13:16:06\r\n * @Last Modified by: TonyJiangWJ\r\n * @Last Modified time: 2022-05-15 14:30:06\r\n * @Description: \r\n */\r\n// AutoJS Pro 使用如下方式引入 解除注释\r\n// importPackage(Packages[\"okhttp3\"])\r\ntry {\r\n  importClass(\"okhttp3.OkHttpClient\")\r\n  importClass(\"okhttp3.FormBody\")\r\n  importClass(\"okhttp3.Request\")\r\n} catch (e) {\r\n  //\r\n}\r\n\r\nconsole.show()\r\n/**\r\n * 下载小米运动APP 现在名字叫 Zepp Life\r\n * 注册一个账号  手机号可以直接注册 邮箱的需要选择地区为 其他\r\n * 这一步非常重要 否则刷的步数无意义：登录后进入APP的第三方接入 绑定到支付宝\r\n * 然后在下面的accounts中配置一下用户名密码 手机号的需要增加+86前缀 邮箱的不需要\r\n * 然后运行当前脚本即可自动刷步数数据 如果不需要随机的步数将min和max改成相同即可 或者可以将范围改大一些\r\n * 运行完毕后APP将会被踢出登录，先试一下 数据能到支付宝之后就可以将APP卸载，后续每天修改步数后都会通过华米自有协议同步到支付宝中不再需要打开APP\r\n * \r\n * 对当前脚本设置一个每日自动执行的定时任务即可每天自动刷步数了 建议时间为晚上\r\n */\r\n\r\n\r\n/**\r\n * 配置需要自动生成步数数据的账号 手机号的需要增加+86前缀\r\n * min,max 设置一个随机的范围 生成随机的步数\r\n */\r\nlet accounts = [\r\n  { userName: '+86手机号', password: '密码', min: 8000, max: 15000 },\r\n  { userName: '邮箱', password: '密码', min: 8000, max: 15000 },\r\n]\r\nlet total = accounts.length\r\naccounts.forEach((config, idx) => {\r\n  console.log('准备生成账号[' + config.userName + ']的步数')\r\n  generateFakeWalkStep(config)\r\n  if (idx < total - 1) {\r\n    console.log('延迟五秒钟执行下一个')\r\n    // 延迟五秒钟\r\n    sleep(5000)\r\n  }\r\n})\r\n\r\n\r\nfunction generateFakeWalkStep (config) {\r\n  let step = generateRandomStep(config.min, config.max)\r\n  let result = fakeWalkData(config.userName, config.password, step, device.getAndroidId())\r\n  if (result) {\r\n    toastLog('账号' + config.userName + '修改步数成功 随机步数：' + step)\r\n  } else {\r\n    toastLog('账号' + config.userName + '修改步数失败')\r\n  }\r\n}\r\n\r\nfunction generateRandomStep (min, max) {\r\n  min = min || 8000\r\n  max = max || 15000\r\n  if (min == max) {\r\n    return min\r\n  }\r\n  if (min > max) {\r\n    min = min + max\r\n    max = min - max\r\n    min = min - max\r\n  }\r\n  return min + parseInt((Math.random() * max) % (max - min))\r\n}\r\n\r\n\r\n\r\nfunction fakeWalkData (userName, password, walkStep, deviceId) {\r\n  let accessToken = getAccessToken(userName, password)\r\n  if (accessToken == null) {\r\n    console.error('获取accessToken失败')\r\n    return false\r\n  }\r\n  let loginResult = login(accessToken, deviceId)\r\n  if (loginResult == null) {\r\n    console.error('登录失败')\r\n    return false\r\n  }\r\n  return changeWalkingStep(loginResult.userId, loginResult.appToken, walkStep, deviceId)\r\n\r\n\r\n  function getAccessToken (userName, password) {\r\n    let requestUrl = 'https://api-user.huami.com/registrations/' + userName + '/tokens'\r\n    let requestBody = new FormBody.Builder()\r\n      .add(\"client_id\", \"HuaMi\")\r\n      .add(\"password\", password)\r\n      .add(\"redirect_uri\", \"https://s3-us-west-2.amazonaws.com/hm-registration/successsignin.html\")\r\n      .add(\"token\", \"access\")\r\n      .build()\r\n    let request = new Request.Builder()\r\n      .addHeader(\"Content-Type\", \"application/x-www-form-urlencoded;charset=UTF-8\")\r\n      .addHeader(\"User-Agent\", \"Mozilla/5.0 (iPhone; CPU iPhone OS 14_7_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2\")\r\n      .url(requestUrl)\r\n      .post(requestBody)\r\n      .build()\r\n    let client = new OkHttpClient.Builder().followRedirects(false).followSslRedirects(false).build()\r\n    let response = client.newCall(request).execute()\r\n    let location = response.header(\"Location\")\r\n    let regex = /.*access=([^&]+)&\\w+=/\r\n    if (!regex.test(location)) {\r\n      console.error('请求access token失败')\r\n      return null\r\n    }\r\n    let accessToken = regex.exec(location)[1]\r\n    return accessToken\r\n  }\r\n\r\n  function login (accessToken, deviceId) {\r\n    let loginUrl = \"https://account.huami.com/v2/client/login\"\r\n    let requestBody = new FormBody.Builder()\r\n      .add(\"app_name\", \"com.xiaomi.hm.health\")\r\n      .add(\"app_version\", \"6.0.1\")\r\n      .add(\"code\", accessToken)\r\n      .add(\"country_code\", \"unknown\")\r\n      .add(\"device_id\", deviceId)\r\n      .add(\"device_model\", \"android_phone\")\r\n      .add(\"grant_type\", \"access_token\")\r\n      .add(\"third_name\", \"huami\")\r\n      .add(\"allow_registration\", \"false\")\r\n      .add(\"dn\", \"account.huami.com%2Capi-user.huami.com%2Capi-watch…m%2Capp-analytics.huami.com%2Capi-mifit.huami.com\")\r\n      .add(\"source\", \"com.xiaomi.hm.health%3A6.0.1%3A50545\")\r\n      .add(\"lang\", \"zh\")\r\n      .build()\r\n    let request = new Request.Builder()\r\n      .addHeader(\"Content-Type\", \"application/x-www-form-urlencoded;charset=UTF-8\")\r\n      .addHeader(\"User-Agent\", \"Mozilla/5.0 (iPhone; CPU iPhone OS 14_7_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.2\")\r\n      .url(loginUrl)\r\n      .post(requestBody)\r\n      .build()\r\n    let client = new OkHttpClient.Builder().followRedirects(false).followSslRedirects(false).build()\r\n    let response = client.newCall(request).execute()\r\n    if (response.isSuccessful()) {\r\n      let responseBody = response.body()\r\n      if (responseBody != null) {\r\n        let responseString = responseBody.string()\r\n        let resultJson = JSON.parse(responseString)\r\n        let tokenInfo = resultJson.token_info\r\n        if (tokenInfo != null) {\r\n          let userId = tokenInfo.user_id\r\n          let appToken = tokenInfo.app_token\r\n          return { userId: userId, appToken: appToken }\r\n        }\r\n      }\r\n    }\r\n    return null\r\n  }\r\n\r\n  function changeWalkingStep (userId, appToken, walkStep, deviceId) {\r\n    let date = new java.text.SimpleDateFormat(\"yyyy-MM-dd\").format(new Date())\r\n    let timeStamp = new Date().getTime()\r\n    let jsonData = \"[{\\\"data_hr\\\":\\\"//////9L////////////Vv///////////0v///////////9e/////0n/a///S////////////0b//////////1FK////////////R/////////////////9PTFFpaf9L////////////R////////////0j///////////9K////////////Ov///////////zf///86/zr/Ov88/zf/Pf///0v/S/8/////////////Sf///////////z3//////0r/Ov//////S/9L/zb/Sf9K/0v/Rf9H/zj/Sf9K/0//N////0D/Sf83/zr/Pf9M/0v/Ov9e////////////S////////////zv//z7/O/83/zv/N/83/zr/N/86/z//Nv83/zn/Xv84/zr/PP84/zj/N/9e/zr/N/89/03/P/89/z3/Q/9N/0v/Tv9C/0H/Of9D/zz/Of88/z//PP9A/zr/N/86/zz/Nv87/0D/Ov84/0v/O/84/zf/MP83/zH/Nv83/zf/N/84/zf/Of82/zf/OP83/zb/Mv81/zX/R/9L/0v/O/9I/0T/S/9A/zn/Pf89/zn/Nf9K/07/N/83/zn/Nv83/zv/O/9A/0H/Of8//zj/PP83/zj/S/87/zj/Nv84/zf/Of83/zf/Of83/zb/Nv9L/zj/Nv82/zb/N/85/zf/N/9J/zf/Nv83/zj/Nv84/0r/Sv83/zf/MP///zb/Mv82/zb/Of85/z7/Nv8//0r/S/85/0H/QP9B/0D/Nf89/zj/Ov83/zv/Nv8//0f/Sv9O/0ZeXv///////////1X///////////9B////////////TP///1b//////0////////////9N/////////v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+/v7+\\\",\\\"date\\\":\\\"\\\",\\\"data\\\":[{\\\"start\\\":0,\\\"stop\\\":1439,\\\"value\\\":\\\"UA8AUBQAUAwAUBoAUAEAYCcAUBkAUB4AUBgAUCAAUAEAUBkAUAwAYAsAYB8AYB0AYBgAYCoAYBgAYB4AUCcAUBsAUB8AUBwAUBIAYBkAYB8AUBoAUBMAUCEAUCIAYBYAUBwAUCAAUBgAUCAAUBcAYBsAYCUAATIPYD0KECQAYDMAYB0AYAsAYCAAYDwAYCIAYB0AYBcAYCQAYB0AYBAAYCMAYAoAYCIAYCEAYCYAYBsAYBUAYAYAYCIAYCMAUB0AUCAAUBYAUCoAUBEAUC8AUB0AUBYAUDMAUDoAUBkAUC0AUBQAUBwAUA0AUBsAUAoAUCEAUBYAUAwAUB4AUAwAUCcAUCYAUCwKYDUAAUUlEC8IYEMAYEgAYDoAYBAAUAMAUBkAWgAAWgAAWgAAWgAAWgAAUAgAWgAAUBAAUAQAUA4AUA8AUAkAUAIAUAYAUAcAUAIAWgAAUAQAUAkAUAEAUBkAUCUAWgAAUAYAUBEAWgAAUBYAWgAAUAYAWgAAWgAAWgAAWgAAUBcAUAcAWgAAUBUAUAoAUAIAWgAAUAQAUAYAUCgAWgAAUAgAWgAAWgAAUAwAWwAAXCMAUBQAWwAAUAIAWgAAWgAAWgAAWgAAWgAAWgAAWgAAWgAAWREAWQIAUAMAWSEAUDoAUDIAUB8AUCEAUC4AXB4AUA4AWgAAUBIAUA8AUBAAUCUAUCIAUAMAUAEAUAsAUAMAUCwAUBYAWgAAWgAAWgAAWgAAWgAAWgAAUAYAWgAAWgAAWgAAUAYAWwAAWgAAUAYAXAQAUAMAUBsAUBcAUCAAWwAAWgAAWgAAWgAAWgAAUBgAUB4AWgAAUAcAUAwAWQIAWQkAUAEAUAIAWgAAUAoAWgAAUAYAUB0AWgAAWgAAUAkAWgAAWSwAUBIAWgAAUC4AWSYAWgAAUAYAUAoAUAkAUAIAUAcAWgAAUAEAUBEAUBgAUBcAWRYAUA0AWSgAUB4AUDQAUBoAXA4AUA8AUBwAUA8AUA4AUA4AWgAAUAIAUCMAWgAAUCwAUBgAUAYAUAAAUAAAUAAAUAAAUAAAUAAAUAAAUAAAUAAAWwAAUAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAeSEAeQ8AcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcBcAcAAAcAAAcCYOcBUAUAAAUAAAUAAAUAAAUAUAUAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcCgAeQAAcAAAcAAAcAAAcAAAcAAAcAYAcAAAcBgAeQAAcAAAcAAAegAAegAAcAAAcAcAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcCkAeQAAcAcAcAAAcAAAcAwAcAAAcAAAcAIAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcCIAeQAAcAAAcAAAcAAAcAAAcAAAeRwAeQAAWgAAUAAAUAAAUAAAUAAAUAAAcAAAcAAAcBoAeScAeQAAegAAcBkAeQAAUAAAUAAAUAAAUAAAUAAAUAAAcAAAcAAAcAAAcAAAcAAAcAAAegAAegAAcAAAcAAAcBgAeQAAcAAAcAAAcAAAcAAAcAAAcAkAegAAegAAcAcAcAAAcAcAcAAAcAAAcAAAcAAAcA8AeQAAcAAAcAAAeRQAcAwAUAAAUAAAUAAAUAAAUAAAUAAAcAAAcBEAcA0AcAAAWQsAUAAAUAAAUAAAUAAAUAAAcAAAcAoAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAYAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcBYAegAAcAAAcAAAegAAcAcAcAAAcAAAcAAAcAAAcAAAeRkAegAAegAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAEAcAAAcAAAcAAAcAUAcAQAcAAAcBIAeQAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcBsAcAAAcAAAcBcAeQAAUAAAUAAAUAAAUAAAUAAAUBQAcBYAUAAAUAAAUAoAWRYAWTQAWQAAUAAAUAAAUAAAcAAAcAAAcAAAcAAAcAAAcAMAcAAAcAQAcAAAcAAAcAAAcDMAeSIAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcAAAcBQAeQwAcAAAcAAAcAAAcAMAcAAAeSoAcA8AcDMAcAYAeQoAcAwAcFQAcEMAeVIAaTYAbBcNYAsAYBIAYAIAYAIAYBUAYCwAYBMAYDYAYCkAYDcAUCoAUCcAUAUAUBAAWgAAYBoAYBcAYCgAUAMAUAYAUBYAUA4AUBgAUAgAUAgAUAsAUAsAUA4AUAMAUAYAUAQAUBIAASsSUDAAUDAAUBAAYAYAUBAAUAUAUCAAUBoAUCAAUBAAUAoAYAIAUAQAUAgAUCcAUAsAUCIAUCUAUAoAUA4AUB8AUBkAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAAfgAA\\\",\\\"tz\\\":32,\\\"did\\\":\\\"\\\",\\\"src\\\":24}],\\\"summary\\\":\\\"\\\",\\\"source\\\":24,\\\"type\\\":0}]\"\r\n    // TODO 重新生成stp数据 目前是固定写死的\r\n    let summary = {\"v\":6,\"slp\":{\"st\":1628296479,\"ed\":1628296479,\"dp\":0,\"lt\":0,\"wk\":0,\"usrSt\":-1440,\"usrEd\":-1440,\"wc\":0,\"is\":0,\"lb\":0,\"to\":0,\"dt\":0,\"rhr\":0,\"ss\":0},\"stp\":{\"ttl\":18272,\"dis\":10627,\"cal\":510,\"wk\":41,\"rn\":50,\"runDist\":7654,\"runCal\":397,\"stage\":[{\"start\":327,\"stop\":341,\"mode\":1,\"dis\":481,\"cal\":13,\"step\":680},{\"start\":342,\"stop\":367,\"mode\":3,\"dis\":2295,\"cal\":95,\"step\":2874},{\"start\":368,\"stop\":377,\"mode\":4,\"dis\":1592,\"cal\":88,\"step\":1664},{\"start\":378,\"stop\":386,\"mode\":3,\"dis\":1072,\"cal\":51,\"step\":1245},{\"start\":387,\"stop\":393,\"mode\":4,\"dis\":1036,\"cal\":57,\"step\":1124},{\"start\":394,\"stop\":398,\"mode\":3,\"dis\":488,\"cal\":19,\"step\":607},{\"start\":399,\"stop\":414,\"mode\":4,\"dis\":2220,\"cal\":120,\"step\":2371},{\"start\":415,\"stop\":427,\"mode\":3,\"dis\":1268,\"cal\":59,\"step\":1489},{\"start\":428,\"stop\":433,\"mode\":1,\"dis\":152,\"cal\":4,\"step\":238},{\"start\":434,\"stop\":444,\"mode\":3,\"dis\":2295,\"cal\":95,\"step\":2874},{\"start\":445,\"stop\":455,\"mode\":4,\"dis\":1592,\"cal\":88,\"step\":1664},{\"start\":456,\"stop\":466,\"mode\":3,\"dis\":1072,\"cal\":51,\"step\":1245},{\"start\":467,\"stop\":477,\"mode\":4,\"dis\":1036,\"cal\":57,\"step\":1124},{\"start\":478,\"stop\":488,\"mode\":3,\"dis\":488,\"cal\":19,\"step\":607},{\"start\":489,\"stop\":499,\"mode\":4,\"dis\":2220,\"cal\":120,\"step\":2371},{\"start\":500,\"stop\":511,\"mode\":3,\"dis\":1268,\"cal\":59,\"step\":1489},{\"start\":512,\"stop\":522,\"mode\":1,\"dis\":152,\"cal\":4,\"step\":238}]},\"goal\":8000,\"tz\":\"28800\"}\r\n    summary.stp.ttl = walkStep\r\n    let postData = JSON.parse(jsonData)[0]\r\n    postData.date = date\r\n    postData.did = deviceId\r\n    postData.summary = JSON.stringify(summary)\r\n    jsonData = JSON.stringify([postData])\r\n    console.verbose(jsonData)\r\n    let url = \"https://api-mifit-cn.huami.com/v1/data/band_data.json?&t=\" + timeStamp\r\n    let requestBody = new FormBody.Builder()\r\n      .add(\"userid\", \"\" + userId)\r\n      .add(\"last_sync_data_time\", (timeStamp / 1000 - 3600).toFixed(0))\r\n      .add(\"device_type\", \"0\")\r\n      .add(\"last_deviceid\", deviceId)\r\n      .add(\"data_json\", jsonData)\r\n      .build()\r\n    let request = new Request.Builder()\r\n      .addHeader(\"Content-Type\", \"application/x-www-form-urlencoded;charset=UTF-8\")\r\n      .addHeader(\"apptoken\", appToken)\r\n      .url(url)\r\n      .post(requestBody)\r\n      .build()\r\n    let client = new OkHttpClient.Builder().followRedirects(false).followSslRedirects(false).build()\r\n    let response = client.newCall(request).execute()\r\n    if (response.isSuccessful()) {\r\n      let responseBody = response.body()\r\n      if (responseBody != null) {\r\n        let result = JSON.parse(responseBody.string())\r\n        return result.message === 'success'\r\n      }\r\n    } else {\r\n      return false\r\n    }\r\n    return false\r\n  }\r\n}\r\n\r\n```\r\n\r\n### 懒得写管理界面，所以就放issue里面 你们自己创建文件吧","reactions":{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/149/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/131","repository_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest","labels_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/131/labels{/name}","comments_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/131/comments","events_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/131/events","html_url":"https://github.com/TonyJiangWJ/Ant-Forest/issues/131","id":1104354374,"node_id":"I_kwDODYW6PM5B0xxG","number":131,"title":"Android12 相关问题以及解决方案汇总","user":{"login":"TonyJiangWJ","id":11325805,"node_id":"MDQ6VXNlcjExMzI1ODA1","avatar_url":"https://avatars.githubusercontent.com/u/11325805?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyJiangWJ","html_url":"https://github.com/TonyJiangWJ","followers_url":"https://api.github.com/users/TonyJiangWJ/followers","following_url":"https://api.github.com/users/TonyJiangWJ/following{/other_user}","gists_url":"https://api.github.com/users/TonyJiangWJ/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyJiangWJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyJiangWJ/subscriptions","organizations_url":"https://api.github.com/users/TonyJiangWJ/orgs","repos_url":"https://api.github.com/users/TonyJiangWJ/repos","events_url":"https://api.github.com/users/TonyJiangWJ/events{/privacy}","received_events_url":"https://api.github.com/users/TonyJiangWJ/received_events","type":"User","site_admin":false},"labels":[{"id":1723540497,"node_id":"MDU6TGFiZWwxNzIzNTQwNDk3","url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/labels/documentation","name":"documentation","color":"0075ca","default":true,"description":"Improvements or additions to documentation"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-01-15T04:11:41Z","updated_at":"2022-05-21T06:50:13Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"目前部分设备升级了MIUI13(Android 12)之后存在以下问题：\r\n- 申请截图权限的时候闪退\r\n  - 需要安装特殊版本的Autojs 目前看来所有的开源版本都扑街了 可以加群获取 或者前往[修改版](https://github.com/TonyJiangWJ/Auto.js/releases/tag/v4.1.1) 下载特殊版本\r\n- 能量雨因为悬浮窗遮挡无法点击\r\n - 方法一： ADB授权一下 禁用 拦截不可信触摸操作 `adb shell settings put global block_untrusted_touches 0`\r\n - 方法二：修改能量雨脚本 第59行插入如下代码\r\n   ```javascript\r\n     ui.post(() => {\r\n       window.setPosition(config.device_width, config.device_height)\r\n     })\r\n    ```","reactions":{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/131/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/131/timeline","performed_via_github_app":null,"state_reason":null},{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/130","repository_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest","labels_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/130/labels{/name}","comments_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/130/comments","events_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/130/events","html_url":"https://github.com/TonyJiangWJ/Ant-Forest/issues/130","id":1104327716,"node_id":"I_kwDODYW6PM5B0rQk","number":130,"title":"ADB授权截图权限，不再弹窗询问","user":{"login":"TonyJiangWJ","id":11325805,"node_id":"MDQ6VXNlcjExMzI1ODA1","avatar_url":"https://avatars.githubusercontent.com/u/11325805?v=4","gravatar_id":"","url":"https://api.github.com/users/TonyJiangWJ","html_url":"https://github.com/TonyJiangWJ","followers_url":"https://api.github.com/users/TonyJiangWJ/followers","following_url":"https://api.github.com/users/TonyJiangWJ/following{/other_user}","gists_url":"https://api.github.com/users/TonyJiangWJ/gists{/gist_id}","starred_url":"https://api.github.com/users/TonyJiangWJ/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TonyJiangWJ/subscriptions","organizations_url":"https://api.github.com/users/TonyJiangWJ/orgs","repos_url":"https://api.github.com/users/TonyJiangWJ/repos","events_url":"https://api.github.com/users/TonyJiangWJ/events{/privacy}","received_events_url":"https://api.github.com/users/TonyJiangWJ/received_events","type":"User","site_admin":false},"labels":[{"id":1723540497,"node_id":"MDU6TGFiZWwxNzIzNTQwNDk3","url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/labels/documentation","name":"documentation","color":"0075ca","default":true,"description":"Improvements or additions to documentation"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-01-15T03:43:42Z","updated_at":"2022-01-26T02:49:21Z","closed_at":null,"author_association":"OWNER","active_lock_reason":null,"body":"- 打开开发者选项 开启ADB调试，连接电脑后用ADB命令授权媒体权限\r\n`adb shell appops set ${packageName} PROJECT_MEDIA allow`\r\n- 不会再每次都弹窗是否授权截图权限了\r\n- ${packageName}自行替换成所使用的AutoJS的包名即可 免费版为 `org.autojs.autojs` 修改版 `org.autojs.autojs.modify` Pro `org.autojs.autojspro`\r\n- 比如给免费版授权：`adb shell appops set org.autojs.autojs PROJECT_MEDIA allow`","reactions":{"url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/130/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/TonyJiangWJ/Ant-Forest/issues/130/timeline","performed_via_github_app":null,"state_reason":null}]